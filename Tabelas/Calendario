let
    // Define a data inicial fixa para o calendário (1º de janeiro de 2025)
    dataInicialDoCalendario = #date(2025, 1, 1),

    // Obtém a data final do calendário baseada na data atual do sistema
    dataFinalDoCalendario = Date.From(DateTime.LocalNow()),

    // Calcula a quantidade de dias entre a data inicial e a data final,
    // adicionando 1 para incluir a data final no intervalo
    qtdeDias = Duration.Days(dataFinalDoCalendario - dataInicialDoCalendario) + 1,

    // Cria uma lista de datas a partir da data inicial, considerando o total de dias calculado
    listaDatas = List.Dates(dataInicialDoCalendario, qtdeDias, #duration(1, 0, 0, 0)),

    // Converte cada data da lista em um registro com informações complementares
    registros = List.Transform(
        listaDatas,
        each
            {
                _, // A própria data
                Text.Proper(Date.DayOfWeekName(_)), // Nome do dia da semana (Ex.: "Segunda-feira")
                Text.Proper(Date.MonthName(_)), // Nome do mês (Ex.: "Janeiro")
                Date.Day(_), // Número do dia do mês (1, 2, ..., 31)
                Date.Month(_), // Número do mês (1 a 12)
                Date.QuarterOfYear(_), // Trimestre do ano (1 a 4)
                Date.Year(_), // Ano
                #date(Date.Year(_), Date.Month(_), 1), // Primeiro dia do mês correspondente
                Date.DayOfWeek(_, Day.Sunday), // Dia da semana como um número (0 = domingo, 6 = sábado)
                Date.ToText(_, "MMyyyy"), // Representação do mês e ano no formato "MMYYYY"
                if DateTime.Date(Date.StartOfMonth(DateTime.LocalNow())) = Date.StartOfMonth(_) 
                   then "MÊS ATUAL" 
                   else Date.ToText(_, "MMyyyy") // Indica se é o mês atual ou mantém o formato "MMYYYY"
            }
    ),

    // Criação da tabela final, organizando os registros gerados com tipos específicos
    tabelaCalendario =
        #table(
            type table[
                Data = date, // Coluna de datas
                Dia Semana = text, // Nome do dia da semana
                Nome Mês = text, // Nome do mês
                Dia = Int64.Type, // Número do dia
                Mês = Int64.Type, // Número do mês
                Trimêstre = Int64.Type, // Número do trimestre
                Ano = Int64.Type, // Ano
                Safra = date, // Primeiro dia do mês
                Dia Útil = Int64.Type, // Identificador numérico do dia da semana
                Mês Ano = text, // Representação "MMYYYY"
                Mês Atual = text // Identificador do mês atual ou formato "MMYYYY"
            ],
            registros
        )
in
   tabelaCalendario
